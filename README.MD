# SystÃ¨me de Consultation MÃ©dicale avec Agents JADE

## Table des matiÃ¨res
1. [Introduction](#introduction)
2. [Architecture du systÃ¨me](#architecture-du-systÃ¨me)
3. [PrÃ©requis](#prÃ©requis)
4. [Installation](#installation)
5. [Configuration](#configuration)
6. [Utilisation](#utilisation)
    - [DÃ©marrer le conteneur principal](#dÃ©marrer-le-conteneur-principal)
    - [DÃ©marrer l'agent mÃ©decin](#dÃ©marrer-lagent-mÃ©decin)
    - [DÃ©marrer l'agent patient](#dÃ©marrer-lagent-patient)
    - [DÃ©roulement d'une consultation](#dÃ©roulement-dune-consultation)
7. [Structure du code](#structure-du-code)
8. [DÃ©pannage](#dÃ©pannage)
9. [Extensions possibles](#extensions-possibles)
10. [Licence](#licence)

## Introduction

Ce systÃ¨me implÃ©mente une application de consultation mÃ©dicale Ã  distance basÃ©e sur l'architecture multi-agents JADE (Java Agent DEvelopment Framework). Le systÃ¨me permet Ã  un agent Patient de communiquer avec un agent MÃ©decin, qui utilise lui-mÃªme un systÃ¨me expert ADK via une API REST pour fournir des rÃ©ponses mÃ©dicales pertinentes.

Le systÃ¨me est conÃ§u pour fonctionner en environnement distribuÃ©, les agents pouvant s'exÃ©cuter sur des machines diffÃ©rentes mais connectÃ©es au mÃªme rÃ©seau.

## Architecture du systÃ¨me

L'architecture du systÃ¨me repose sur trois composants principaux :

1. **Agent Patient** : Interface utilisateur permettant Ã  un patient de communiquer ses symptÃ´mes et de recevoir des rÃ©ponses mÃ©dicales.
2. **Agent MÃ©decin** : Interface de traitement des messages du patient, utilisant une API externe pour gÃ©nÃ©rer des rÃ©ponses mÃ©dicales appropriÃ©es.
3. **SystÃ¨me Expert ADK** : API REST Python qui implÃ©mente un systÃ¨me expert mÃ©dical capable d'analyser les symptÃ´mes et de proposer des diagnostics.

La communication entre les agents est assurÃ©e par le framework JADE, et la communication avec le systÃ¨me expert est rÃ©alisÃ©e via HTTP/REST.

## PrÃ©requis

- Java Development Kit (JDK) 11 ou supÃ©rieur
- Maven 3.6.0 ou supÃ©rieur
- Python 3.7 ou supÃ©rieur (pour le systÃ¨me expert ADK)
- Framework JADE 4.5.0
- Connexion rÃ©seau entre les machines si vous exÃ©cutez les agents sur diffÃ©rentes machines

## Installation

### 1. Cloner le dÃ©pÃ´t

```bash
git clone https://github.com/yourusername/jade-medical-consultation.git
cd jade-medical-consultation
```

### 2. Installer les dÃ©pendances Maven

```bash
mvn clean install
```

### 3. Installer et dÃ©marrer le systÃ¨me expert ADK

```bash
# Dans un rÃ©pertoire sÃ©parÃ©
git clone https://github.com/yourusername/medical-expert-adk.git
cd medical-expert-adk
pip install -r requirements.txt
python api_server.py
```

## Configuration

### Configuration du SystÃ¨me Expert ADK

Par dÃ©faut, le systÃ¨me expert ADK s'exÃ©cute sur l'hÃ´te local (localhost) sur le port 8000. Si vous souhaitez modifier cette configuration, vous pouvez Ã©diter le fichier `api_server.py` du systÃ¨me expert.

### Configuration des Agents JADE

Les agents peuvent Ãªtre configurÃ©s lors de leur dÃ©marrage. Vous pouvez spÃ©cifier :

- L'adresse du conteneur principal JADE
- Le nom des agents
- L'URL de l'API du systÃ¨me expert
- Le nom de l'agent mÃ©decin Ã  contacter

## Utilisation

### DÃ©marrer le conteneur principal

Le conteneur principal JADE doit Ãªtre dÃ©marrÃ© en premier, car il hÃ©berge les services nÃ©cessaires Ã  la communication entre les agents.

```bash
java -cp "lib/*:target/jade-medical-consultation-1.0.0.jar" org.medecine.jade.MainContainer
```

Un message confirmant le dÃ©marrage du conteneur principal s'affichera :

```
Conteneur principal dÃ©marrÃ© avec succÃ¨s!
```

### DÃ©marrer l'agent mÃ©decin

Une fois le conteneur principal dÃ©marrÃ©, lancez l'agent mÃ©decin :

```bash
java -cp "lib/*:target/jade-medical-consultation-1.0.0.jar" org.medecine.jade.MedecinContainer
```

Le programme vous demandera quelques informations :

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     SYSTÃˆME DE CONSULTATION MÃ‰DICALE - MÃ‰DECIN    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Adresse IP du conteneur principal (laisser vide pour localhost):
```

Entrez l'adresse IP du conteneur principal ou laissez vide pour utiliser localhost.

```
Nom de l'agent mÃ©decin [medecin]:
```

Vous pouvez spÃ©cifier un nom personnalisÃ© ou laisser vide pour utiliser le nom par dÃ©faut "medecin".

```
URL de l'API du systÃ¨me expert [http://localhost:8000]:
```

Indiquez l'URL de l'API du systÃ¨me expert ou laissez vide pour utiliser l'URL par dÃ©faut.

Une fois configurÃ©, l'agent mÃ©decin dÃ©marrera et sera prÃªt Ã  recevoir des patients :

```
Agent MÃ©decin 'medecin' dÃ©marrÃ© avec succÃ¨s!
```

### DÃ©marrer l'agent patient

Lancez l'agent patient, qui reprÃ©sente l'interface utilisateur pour le patient :

```bash
java -cp "lib/*:target/jade-medical-consultation-1.0.0.jar" org.medecine.jade.PatientContainer
```

Le programme vous demandera Ã©galement quelques informations :

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     SYSTÃˆME DE CONSULTATION MÃ‰DICALE - PATIENT    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Adresse IP du conteneur principal (laisser vide pour localhost):
```

Entrez l'adresse IP du conteneur principal ou laissez vide pour utiliser localhost.

```
Votre nom:
```

Entrez votre nom. Si vous laissez vide, un nom sera gÃ©nÃ©rÃ© automatiquement.

```
Nom de l'agent mÃ©decin Ã  contacter [medecin]:
```

Indiquez le nom de l'agent mÃ©decin Ã  contacter ou laissez vide pour utiliser le nom par dÃ©faut "medecin".

Une fois configurÃ©, l'agent patient recherchera l'agent mÃ©decin et dÃ©marrera la consultation :

```
Agent Patient 'votrenom' dÃ©marrÃ© avec succÃ¨s!
Recherche du mÃ©decin 'medecin'...
En attente du mÃ©decin.....
MÃ©decin trouvÃ©: medecin
DÃ©but de la consultation...
```

### DÃ©roulement d'une consultation

Une fois la connexion Ã©tablie, le patient peut commencer Ã  dÃ©crire ses symptÃ´mes :

```
La consultation commence maintenant. DÃ©crivez vos symptÃ´mes ou posez des questions au mÃ©decin.
Tapez 'exit' pour terminer la consultation.
> J'ai mal Ã  la tÃªte et de la fiÃ¨vre depuis hier.
```

Le mÃ©decin, via le systÃ¨me expert, traitera l'information et rÃ©pondra :

```
Dr. medecin: Merci de me consulter. Pourriez-vous me prÃ©ciser Ã  quel endroit exactement vous ressentez cette douleur Ã  la tÃªte et Ã  combien estimez-vous votre tempÃ©rature ?
```

La consultation se poursuit avec l'Ã©change de messages entre le patient et le mÃ©decin. Lorsque le systÃ¨me expert dÃ©termine qu'il dispose de suffisamment d'informations pour Ã©tablir un diagnostic, il enverra un message spÃ©cial contenant "END_DIAG", ce qui mettra fin Ã  la consultation.

Pour terminer manuellement la consultation, tapez simplement `exit` :

```
> exit
Demande de fin de consultation envoyÃ©e.
```

## Structure du code

La structure du projet est organisÃ©e de la maniÃ¨re suivante :

```
src/
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â””â”€â”€ org/
â”‚   â”‚       â””â”€â”€ medecine/
â”‚   â”‚           â”œâ”€â”€ agents/         # Classes des agents JADE
â”‚   â”‚           â”œâ”€â”€ behaviours/     # Comportements des agents
â”‚   â”‚           â”‚   â”œâ”€â”€ medecin/    # Comportements spÃ©cifiques au mÃ©decin
â”‚   â”‚           â”‚   â””â”€â”€ patient/    # Comportements spÃ©cifiques au patient
â”‚   â”‚           â”œâ”€â”€ gui/            # Classes liÃ©es Ã  l'interface console
â”‚   â”‚           â”œâ”€â”€ jade/           # Classes de conteneurs JADE
â”‚   â”‚           â”œâ”€â”€ models/         # ModÃ¨les de donnÃ©es
â”‚   â”‚           â””â”€â”€ utils/          # Classes utilitaires
â”‚   â””â”€â”€ resources/                  # Ressources (art ASCII, configuration)
```

### Principaux composants

#### Agents
- **MedecinAgent**: Agent qui reprÃ©sente le mÃ©decin virtuel.
- **PatientAgent**: Agent qui reprÃ©sente l'interface patient.

#### Comportements
- **WaitForPatientBehaviour**: Attend la connexion d'un patient.
- **ConsultationBehaviour**: GÃ¨re la consultation mÃ©dicale.
- **DoctorResponseBehaviour**: Ã‰coute les rÃ©ponses du mÃ©decin.
- **InputThread**: Thread sÃ©parÃ© pour gÃ©rer les entrÃ©es utilisateur.

#### ModÃ¨les
- **ConsultationSession**: Contient les informations d'une session de consultation.
- **ConsultationState**: Enum reprÃ©sentant les Ã©tats possibles d'une consultation.
- **ResponseMessage**: ReprÃ©sente une rÃ©ponse du systÃ¨me expert.

#### Utilitaires
- **APIClient**: Client REST pour communiquer avec le systÃ¨me expert.
- **AgentFinder**: Utilitaire pour rechercher des agents dans la plateforme JADE.
- **ConsoleManager**: Gestionnaire de l'interface console avec effets visuels.

## DÃ©pannage

### ProblÃ¨mes de connexion avec le conteneur principal

Si les agents ne parviennent pas Ã  se connecter au conteneur principal, vÃ©rifiez que :
- Le conteneur principal est bien dÃ©marrÃ©
- L'adresse IP spÃ©cifiÃ©e est correcte
- Aucun pare-feu ne bloque la communication sur le port 1099 (port par dÃ©faut de JADE)

```bash
# Pour vÃ©rifier si le port est ouvert sur Linux
netstat -an | grep 1099

# Pour vÃ©rifier sur Windows
netstat -an | findstr 1099
```

### ProblÃ¨mes de communication avec le systÃ¨me expert

Si l'agent mÃ©decin ne parvient pas Ã  communiquer avec le systÃ¨me expert :
- VÃ©rifiez que le serveur API est bien dÃ©marrÃ©
- VÃ©rifiez l'URL configurÃ©e
- Assurez-vous qu'aucun pare-feu ne bloque la communication

### Messages non affichÃ©s ou dÃ©calÃ©s

Si les messages ne s'affichent pas correctement ou avec du retard :
- VÃ©rifiez que les comportements d'Ã©coute sont correctement configurÃ©s
- VÃ©rifiez la console du mÃ©decin pour voir si les messages sont bien reÃ§us
- RedÃ©marrez l'application si nÃ©cessaire

### Erreurs JADE

Pour les erreurs liÃ©es Ã  JADE, consultez les logs pour plus de dÃ©tails. Les erreurs courantes incluent :
- ProblÃ¨mes d'enregistrement des agents dans le service DF
- ProblÃ¨mes de noms d'agent en double
- Erreurs de communication ACL

## Extensions possibles

Le systÃ¨me peut Ãªtre Ã©tendu de plusieurs faÃ§ons :

1. **Interface graphique** : Remplacer l'interface console par une interface graphique Swing ou JavaFX.
2. **Historique des consultations** : Ajouter la possibilitÃ© de sauvegarder l'historique des consultations.
3. **Authentification** : Ajouter un systÃ¨me d'authentification pour les patients et les mÃ©decins.
4. **Plusieurs mÃ©decins** : Permettre Ã  plusieurs mÃ©decins de s'enregistrer avec diffÃ©rentes spÃ©cialitÃ©s.
5. **Mode hors ligne** : Ajouter la possibilitÃ© de fonctionner sans connexion constante au systÃ¨me expert.

## Licence

Ce projet est sous licence MIT. Voir le fichier LICENSE pour plus de dÃ©tails.

---

## Guide de dÃ©veloppement

### Ajout de nouvelles fonctionnalitÃ©s

Pour ajouter de nouvelles fonctionnalitÃ©s, suivez ces Ã©tapes :

1. **Identifiez le composant concernÃ©** :
    - S'il s'agit d'une nouvelle fonctionnalitÃ© pour le mÃ©decin, modifiez les classes dans le package `medecin`
    - S'il s'agit d'une fonctionnalitÃ© pour le patient, travaillez dans le package `patient`

2. **CrÃ©ez de nouveaux comportements** :
    - Les comportements JADE sont la base de toute fonctionnalitÃ©
    - Ã‰tendez `CyclicBehaviour`, `OneShotBehaviour` ou `TickerBehaviour` selon vos besoins

3. **Mettez Ã  jour les modÃ¨les** :
    - Si votre fonctionnalitÃ© nÃ©cessite de nouvelles donnÃ©es, ajoutez-les aux modÃ¨les existants
    - Ou crÃ©ez de nouveaux modÃ¨les dans le package `models`

4. **Testez votre code** :
    - Testez d'abord en local (tous les agents sur la mÃªme machine)
    - Puis testez en environnement distribuÃ© si nÃ©cessaire

### Personnalisation de l'interface console

L'interface console peut Ãªtre personnalisÃ©e en modifiant les mÃ©thodes de la classe `ConsoleManager` :

```java
// Modifier les couleurs
ConsoleManager.RED = "\u001B[38;5;196m"; // Rouge plus vif
ConsoleManager.GREEN = "\u001B[38;5;46m"; // Vert plus vif

// Ajouter de nouvelles mÃ©thodes d'affichage
public static void printHighlight(String message) {
    System.out.println(YELLOW + BOLD + "ğŸ” " + message + RESET);
}
```

### DÃ©bogage

Pour dÃ©boguer efficacement l'application, vous pouvez activer le mode debug de JADE :

```bash
java -Djade.util.Logger.properties=jade_logging.properties -cp "lib/*:target/jade-medical-consultation-1.0.0.jar" org.medecine.jade.MainContainer
```

Et crÃ©er un fichier `jade_logging.properties` avec le contenu suivant :

```properties
handlers=java.util.logging.ConsoleHandler
.level=INFO
jade.level=FINE
jade.core.level=FINE
```

Cela affichera plus d'informations sur le fonctionnement interne de JADE.

